{"version":3,"sources":["webpack:///./src/views/Images/Images.vue?cdd3","webpack:///./src/views/Images/Images.vue?5838","webpack:///src/views/Images/Images.vue","webpack:///./src/views/Images/Images.vue?59f1","webpack:///./src/views/Images/Images.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","staticStyle","model","value","callback","$$v","radio1","expression","on","$event","dialogVisible","_l","item","key","id","url","style","color","is_collected","collectFn","delImg","reqParams","page","per_page","total","hPageChange","handleSizeChange","headers","hUploadSuccess","beforeAvatarUpload","imgSrc","staticRenderFns","name","data","collect","listArr","Authorization","sessionStorage","getItem","watch","getImgListFn","methods","val","$confirm","confirmButtonText","cancelButtonText","type","message","res","$message","success","isJPG","error","isLt2M","component"],"mappings":"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","file":"js/chunk-8605336c.a6a81763.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Images.vue?vue&type=style&index=0&id=5904577f&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"image-container\"},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('el-breadcrumb',[_c('el-breadcrumb-item',{attrs:{\"to\":\"/\"}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"素材管理\")])],1)],1),_c('div',{staticStyle:{\"padding-bottom\":\"20px\"}},[_c('el-radio-group',{attrs:{\"size\":\"mini\"},model:{value:(_vm.radio1),callback:function ($$v) {_vm.radio1=$$v},expression:\"radio1\"}},[_c('el-radio-button',{attrs:{\"label\":\"全部\"}}),_c('el-radio-button',{attrs:{\"label\":\"收藏\"}})],1)],1),_c('el-button',{staticStyle:{\"float\":\"right\",\"margin-top\":\"-50px\"},attrs:{\"type\":\"success\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.dialogVisible = true}}},[_vm._v(\"上传图片素材 \")]),_c('el-row',{attrs:{\"gutter\":10}},_vm._l((_vm.listArr),function(item){return _c('el-col',{key:item.id,staticClass:\"img_item\",attrs:{\"xs\":12,\"sm\":6,\"md\":6,\"lg\":4}},[_c('el-image',{staticStyle:{\"height\":\"180px\",\"width\":\"100%\"},attrs:{\"src\":item.url,\"fit\":\"cover\"}}),_c('div',{staticClass:\"option\"},[_c('span',{staticClass:\"el-icon-star-on\",style:({color:item.is_collected ?'red':''}),on:{\"click\":function($event){return _vm.collectFn(item)}}}),_c('span',{staticClass:\"el-icon-delete\",on:{\"click\":function($event){return _vm.delImg(item)}}})])],1)}),1),_c('el-pagination',{staticStyle:{\"margin-top\":\"10px\"},attrs:{\"background\":\"\",\"layout\":\"total, sizes, prev, pager, next, jumper\",\"page-sizes\":[8, 12, 16, 20],\"current-page\":_vm.reqParams.page,\"page-size\":_vm.reqParams.per_page,\"total\":_vm.total},on:{\"current-change\":_vm.hPageChange,\"size-change\":_vm.handleSizeChange}}),_c('el-dialog',{attrs:{\"title\":\"提示\",\"append-to-body\":true,\"visible\":_vm.dialogVisible},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":\"http://api-toutiao-web.itheima.net/mp/v1_0/user/images\",\"headers\":_vm.headers,\"on-success\":_vm.hUploadSuccess,\"name\":\"image\",\"show-file-list\":false,\"before-upload\":_vm.beforeAvatarUpload}},[(_vm.imgSrc)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.imgSrc}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"image-container\">\r\n    <el-card class=\"box-card\">\r\n      <div slot=\"header\">\r\n        <el-breadcrumb>\r\n          <el-breadcrumb-item to=\"/\">首页</el-breadcrumb-item>\r\n          <el-breadcrumb-item>素材管理</el-breadcrumb-item>\r\n        </el-breadcrumb>\r\n      </div>\r\n      <div style=\"padding-bottom: 20px\">\r\n        <el-radio-group size=\"mini\" v-model=\"radio1\">\r\n          <el-radio-button label=\"全部\"></el-radio-button>\r\n          <el-radio-button label=\"收藏\"></el-radio-button>\r\n        </el-radio-group>\r\n      </div>\r\n              <el-button\r\n          @click=\"dialogVisible = true\"\r\n          type=\"success\"\r\n          size=\"mini\"\r\n          style=\"float: right;margin-top:-50px\"\r\n          >上传图片素材\r\n        </el-button>\r\n      <!-- 素材列表 -->\r\n<el-row :gutter=\"10\">\r\n        <el-col class=\"img_item\" :xs=\"12\" :sm=\"6\" :md=\"6\" :lg=\"4\" v-for=\"item in listArr\"\r\n            :key=\"item.id\">\r\n          <el-image\r\n            style=\"height: 180px; width: 100%\"\r\n            :src=\"item.url\"\r\n            fit=\"cover\"\r\n\r\n          ></el-image>\r\n          <div class=\"option\">\r\n            <span class=\"el-icon-star-on\" :style=\"{color:item.is_collected ?'red':''}\" @click=\"collectFn(item)\"></span>\r\n            <span class=\"el-icon-delete\" @click=\"delImg(item)\"></span>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      <!-- /素材列表 -->\r\n            <!-- 分页 -->\r\n      <el-pagination\r\n        style=\"margin-top: 10px\"\r\n        background\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n        :page-sizes=\"[8, 12, 16, 20]\"\r\n        @current-change=\"hPageChange\"\r\n        @size-change=\"handleSizeChange\"\r\n        :current-page=\"reqParams.page\"\r\n        :page-size=\"reqParams.per_page\"\r\n        :total=\"total\"\r\n      >\r\n      </el-pagination>\r\n            <!-- 对话框 -->\r\n      <el-dialog\r\n        title=\"提示\"\r\n        :append-to-body=\"true\"\r\n        :visible.sync=\"dialogVisible\"\r\n      >\r\n<!--\r\n        action：上传地址\r\n        show-file-list:false，不需要显示已上传的文件列表\r\n        on-success： 上传成功之后的回调函数\r\n        before-upload: 上传之前对文件进行检测\r\n        name: 设置上传的文件参数名，要与后端接口中的要求一致。\r\n      -->\r\n        <el-upload\r\n          class=\"avatar-uploader\"\r\n          action=\"http://api-toutiao-web.itheima.net/mp/v1_0/user/images\"\r\n          :headers=\"headers\"\r\n          :on-success=\"hUploadSuccess\"\r\n          name=\"image\"\r\n          :show-file-list=\"false\"\r\n          :before-upload=\"beforeAvatarUpload\"\r\n        >\r\n          <!-- 如果当前有预览地址就说明图片上传成功了。 -->\r\n          <img v-if=\"imgSrc\" :src=\"imgSrc\" class=\"avatar\" />\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n        </el-upload>\r\n      </el-dialog>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { imgListAPI, collectedImgAPI, imgDelAPI } from '@/api'\r\nexport default {\r\n  name: 'images',\r\n  data () {\r\n    return {\r\n      dialogVisible: false,\r\n      reqParams: {\r\n        collect: false,\r\n        page: 1,\r\n        per_page: 8\r\n      },\r\n      listArr: [],\r\n      radio1: '全部',\r\n      total: 0,\r\n      imgSrc: '',\r\n      headers: {\r\n        Authorization: 'Bearer ' + sessionStorage.getItem('token')\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    radio1 (newVal) {\r\n      this.reqParams.page = 1\r\n      this.reqParams.collect = (newVal !== '全部')\r\n      this.getImgListFn()\r\n      // if (newVal===全部) {\r\n      // }\r\n    }\r\n  },\r\n  methods: {\r\n    async getImgListFn () {\r\n      const [err, res] = await imgListAPI(this.reqParams)\r\n      if (err) return\r\n      // console.log(res)\r\n      this.listArr = res.data.data.results\r\n      this.total = res.data.data.total_count\r\n    },\r\n    async collectFn (obj) {\r\n      this.reqParams.page = 1\r\n      const [err] = await collectedImgAPI(obj.id, { collect: !obj.is_collected })\r\n      if (err) return\r\n      // console.log(res)\r\n      this.getImgListFn()\r\n    },\r\n    hPageChange (page) {\r\n      this.reqParams.page = page\r\n      this.getImgListFn()\r\n    },\r\n    handleSizeChange (val) {\r\n      // console.log(val)\r\n      this.reqParams.per_page = val\r\n      this.getImgListFn()\r\n    },\r\n    delImg (obj) {\r\n      this.$confirm('确定删除该图片？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(async () => {\r\n        const [err] = await imgDelAPI(obj.id)\r\n        if (err) return\r\n        this.$message({\r\n          type: 'success',\r\n          message: '删除成功!'\r\n        })\r\n        this.getImgListFn()\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '已取消删除'\r\n        })\r\n      })\r\n    },\r\n    hUploadSuccess (res, file) {\r\n      this.imgSrc = res.data.url\r\n      this.$message.success('图片素材上传成功')\r\n      this.dialogVisible = false\r\n      this.getImgListFn()\r\n    },\r\n    beforeAvatarUpload (file) {\r\n      const isJPG = file.type === 'image/jpeg'\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n      if (!isJPG) {\r\n        this.$message.error('图片只能是 JPG 格式 / PNG 格式!')\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('图片大小不能超过 2MB!')\r\n      }\r\n      return isJPG && isLt2M // 如果返回true就开始上传\r\n    }\r\n  },\r\n\r\n  async created () {\r\n    this.getImgListFn()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n .img_item {\r\n    position: relative;\r\n    box-sizing: border-box;\r\n  }\r\n  .option {\r\n    position: absolute;\r\n    left: 5px;\r\n    right:5px;\r\n    bottom: 5px;\r\n    height: 30px;\r\n    line-height: 30px;\r\n    background: rgba(0, 0, 0, 0.3);\r\n    text-align: center;\r\n    color: #fff;\r\n    span {\r\n      margin: 0 30px;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n.avatar-uploader {\r\n    text-align: center;\r\n}\r\n.avatar-uploader-icon {\r\n    font-size: 28px;\r\n    color: #8c939d;\r\n    width: 178px;\r\n    height: 178px;\r\n    line-height: 178px;\r\n    text-align: center;\r\n}\r\n.avatar-uploader /deep/ .el-upload {\r\n    border: 1px dashed #d9d9d9;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    position: relative;\r\n    overflow: hidden;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Images.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Images.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Images.vue?vue&type=template&id=5904577f&scoped=true&\"\nimport script from \"./Images.vue?vue&type=script&lang=js&\"\nexport * from \"./Images.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Images.vue?vue&type=style&index=0&id=5904577f&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5904577f\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}